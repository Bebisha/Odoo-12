<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <!-- Inherit move.line.operation Form View to Modify it -->
    <record id="stock_move_line_operation_tree_auto_lot" model="ir.ui.view">
        <field name="name">stock.move.line.operation.tree.auto.lot</field>
        <field name="model">stock.move.line</field>
        <field name="inherit_id"
               ref="stock.view_stock_move_line_operation_tree"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='lot_id']" position="before">
                <field name="lot_year_id"
                       groups="stock.group_production_lot" invisible="not context.get('show_lots_m2o')"/>
                <field name="lot_months_id"
                       groups="stock.group_production_lot" invisible="not context.get('show_lots_m2o')"/>
            </xpath>
            <xpath expr="//tree/field[@name='lot_id']" position="attributes">
                <attribute name="context">{'default_product_id': parent.product_id, 'active_picking_id': picking_id, 'lot_months_id': lot_months_id, 'lot_year_id': lot_year_id}</attribute>
            </xpath>
        </field>
    </record>

     <!--Inherit Form View to Modify stock.picking.form-->
    <!--<record id="view_picking_form_auto_lot" model="ir.ui.view">-->
        <!--<field name="name">view.picking.form.auto.lot</field>-->
        <!--<field name="model">stock.picking</field>-->
        <!--<field name="inherit_id" ref="stock.view_picking_form"/>-->
        <!--<field name="arch" type="xml">-->
            <!--<xpath-->
                    <!--expr="//field[@name='move_line_ids_without_package']/tree/field[@name='lot_id']"-->
                   <!--position="before">-->
                <!--<field name="lot_year_id"-->
                       <!--groups="stock.group_production_lot"-->
                       <!--attrs="{'column_invisible': [('parent.show_lots_text', '=', True)], 'invisible': [('lots_visible', '=', False)], }"/>-->
                <!--<field name="lot_months_id"-->
                       <!--groups="stock.group_production_lot"-->
                       <!--attrs="{'column_invisible': [('parent.show_lots_text', '=', True)], 'invisible': [('lots_visible', '=', False)],}"/>-->
            <!--</xpath>-->
            <!--<xpath expr="//field[@name='move_line_ids_without_package']/tree/field[@name='lot_id']"-->
                   <!--position="attributes">-->
                <!--<attribute name="context">{'default_product_id': product_id, 'lot_months_id': lot_months_id, 'lot_year_id': lot_year_id}</attribute>-->
            <!--</xpath>-->
        <!--</field>-->
    <!--</record>-->

</odoo>